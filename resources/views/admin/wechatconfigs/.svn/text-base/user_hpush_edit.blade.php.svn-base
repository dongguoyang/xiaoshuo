<link href="/admin/layui/css/layui.css" rel="stylesheet">
<div class="box">
{{--    <hr style="border-color: #fff;margin: 0;">--}}
    <ul class="nav nav-pills">
        <li><a href="index">æˆæƒä¿¡æ¯</a></li>
        <li><a href="subscribe">å¤–æ¨å…³æ³¨å›å¤</a></li>
        <li><a href="searchsub">ç›´æ¥å…³æ³¨å›å¤</a></li>
        <li><a href="usertags">ç”¨æˆ·æ ‡ç­¾é…ç½®</a></li>
        <li><a href="/{{config('admin.route.prefix')}}/wechat_msg_replies">å…³é”®è¯å›å¤ç®¡ç†</a></li>
        <li><a href="menulist">èœå•è®¾ç½®</a></li>
        <li><a href="/{{config('admin.route.prefix')}}/interactivemsg">äº’åŠ¨æ¶ˆæ¯</a></li>
        <li><a href="pushconf">æ™ºèƒ½æ¨é€</a></li>
        <li><a href="dailypush">æ¯æ—¥æ¨é€</a></li>
        <li><a href="subscribenext">æ–°ç”¨æˆ·ç¬¬äºŒæ¬¡æ¨é€</a></li>
        <li class="active"><a href="userhpush">æ¯æ—¥è‡ªå®šä¹‰æ¨é€</a></li>
    </ul>

    <style>
        .col-sm-12{margin-bottom: 30px;}
        .item {-webkit-tap-highlight-color: rgba(0,0,0,0);box-shadow: 0px 0px 10px #e8ebed;border-radius: 2px;box-sizing: border-box;
            border: 1px solid #e8ebed;padding: 20px 10px;}
        .item>div:first-child{height: 300px;}
        .item>div:nth-child(2){height: 40px;border-top: 1px solid #ddd;text-align: center;}
        .item>div:nth-child(2) .layui-input-block {margin: 0;}

        .descinfo{padding: 20px 15px;line-height: 28px;}
    </style>
    <form method="post" accept-charset="UTF-8" id="ajaxform" class="form-horizontal ajaxform" enctype="multipart/form-data">
        <input type="hidden" name="id" value="{{$wechat['id']}}">
        <hr>
        <span class="help-block" style="margin-left: 50px;"> <i class="fa fa-info-circle"></i>&nbsp;æ ‡é¢˜ï¼Œæè¿°æœ€é•¿30ä¸ªå­—ï¼›æ¨é€æ—¶é—´åªèƒ½å¡«å†™æ•´æ•° 0-23ï¼ˆå–å€¼èŒƒå›´åœ¨0-23å¤–ï¼Œè¯¥é¡¹é…ç½®å°†å¤±æ•ˆåˆ é™¤ï¼‰ï¼› </span>
        <hr>

        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">æ¨é€å°è¯´ 1</label>
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <select class="form-control select2" data-for="title0" style="width: 100%;" name="s[0][n]" >
                        <option value="">--- è¯·é€‰æ‹©å°è¯´ ---</option>
                        @foreach($novels as $v)
                            <option value="{{$v['id']}}" @if(isset($user_hpush['s'][0]['n']) && $v['id'] == $user_hpush['s'][0]['n']) selected @endif>{{$v['title']}}</option>
                        @endforeach
                    </select>
                </div>
            </div>
            <label for="type" class="col-sm-1  control-label">æ¨é€æ—¶é—´ï¼š</label>
            <div class="col-sm-3">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input type="number" class="form-control" style="width: 100%;" name="s[0][h]"  @if(isset($user_hpush['s'][0]['h'])) value="{{intval($user_hpush['s'][0]['h'])}}" @endif>
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">æ¨é€æ ‡é¢˜</label>
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input maxlength="30"  type="text" id="title0" name="s[0][t]" value="@if(isset($user_hpush['s'][0]['t']) && $user_hpush['s'][0]['t']) {{$user_hpush['s'][0]['t']}}  @endif" class="form-control type" placeholder="è¾“å…¥ æ ‡é¢˜">
                </div>
            </div>

            <label for="type" class="col-sm-1  control-label">æ¨é€æè¿°</label>
            <div class="col-sm-3">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input maxlength="30"  type="text"  name="s[0][d]" value="@if(isset($user_hpush['s'][0]['d']) && $user_hpush['s'][0]['d']) {{$user_hpush['s'][0]['d']}} @else   ğŸ‘†ğŸ‘†ğŸ‘†ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ @endif" class="form-control type" placeholder="è¾“å…¥ æ ‡é¢˜">
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">å›¾ç‰‡</label>
            <div class="col-sm-8">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input  type="text"  name="s[0][p]" value="@if(isset($user_hpush['s'][0]['p']) && $user_hpush['s'][0]['p']) {{$user_hpush['s'][0]['p']}} @endif" class="form-control type" placeholder="è¾“å…¥ å›¾ç‰‡åœ°å€">
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <hr style="width: 80%;margin-left: 8%;">
        </div>

        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">æ¨é€å°è¯´ 2</label>
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <select class="form-control select2" data-for="title1" style="width: 100%;" name="s[1][n]" >
                        <option value="">--- è¯·é€‰æ‹©å°è¯´ ---</option>
                        @foreach($novels as $v)
                            <option value="{{$v['id']}}" @if(isset($user_hpush['s'][1]['n']) && $v['id'] == $user_hpush['s'][1]['n']) selected @endif>{{$v['title']}}</option>
                        @endforeach
                    </select>
                </div>
            </div>
            <label for="type" class="col-sm-1  control-label">æ¨é€æ—¶é—´ï¼š</label>
            <div class="col-sm-3">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input type="number" class="form-control" style="width: 100%;" name="s[1][h]"  @if(isset($user_hpush['s'][1]['h'])) value="{{intval($user_hpush['s'][1]['h'])}}" @endif>
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">æ¨é€æ ‡é¢˜</label>
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input maxlength="30"  type="text" id="title1" name="s[1][t]" value="@if(isset($user_hpush['s'][1]['t']) && $user_hpush['s'][1]['t']) {{$user_hpush['s'][1]['t']}}  @endif" class="form-control type" placeholder="è¾“å…¥ æ ‡é¢˜">
                </div>
            </div>

            <label for="type" class="col-sm-1  control-label">æ¨é€æè¿°</label>
            <div class="col-sm-3">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input maxlength="30"  type="text"  name="s[1][d]" value="@if(isset($user_hpush['s'][1]['d']) && $user_hpush['s'][1]['d']) {{$user_hpush['s'][1]['d']}} @else   ğŸ‘†ğŸ‘†ğŸ‘†ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ @endif" class="form-control type" placeholder="è¾“å…¥ æ ‡é¢˜">
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <label for="type" class="col-sm-2  control-label">å›¾ç‰‡</label>
            <div class="col-sm-8">
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-pencil fa-fw"></i></span>
                    <input  type="text"  name="s[1][p]" value="@if(isset($user_hpush['s'][1]['p']) && $user_hpush['s'][1]['p']) {{$user_hpush['s'][1]['p']}} @endif" class="form-control type" placeholder="è¾“å…¥ å›¾ç‰‡åœ°å€">
                </div>
            </div>
        </div>
        <div class="form-group  " style="margin-top: 20px;">
            <hr style="width: 80%;margin-left: 8%;">
        </div>

        <div style="text-align: center;padding-bottom: 50px;">
            <input type="reset" value="é‡ç½®" class="btn btn-warning" style="margin-right: 50px;">
            <input type="submit" value="æäº¤" class="btn btn-success">
        </div>
    </form>

</div>

{{--<script src="/vendor/laravel-admin/AdminLTE/plugins/jQuery/jQuery-2.1.4.min.js"></script>--}}
<script src="/admin/layui/layui.js"></script>
<script>
    $("#submitdo").on('click', function () {
        $.post('#', $('.layui-form').serialize(), function(data){
            if (typeof layer == 'undefined') {
                alert(data.msg);
            }
            layer.msg(data.msg);
        });
        return false;
    });

    var fileinputOptions = {
        language: 'zh', //è®¾ç½®è¯­è¨€
        uploadUrl: 'uploadUrl',
        showUpload: false, //æ˜¯å¦æ˜¾ç¤ºä¸Šä¼ æŒ‰é’®
        showRemove:false,
        overwriteInitial: false,
        showPreview : true,
        dropZoneEnabled: false,
        showCaption: true,//æ˜¯å¦æ˜¾ç¤ºæ ‡é¢˜
        allowedPreviewTypes: ['image'],
        allowedFileTypes: ['image'],
        allowedFileExtensions:  ['jpg', 'png', 'gif'],
        maxFileSize : 200,
        maxFileCount: 1,
        initialPreviewAsData: true,
        initialPreview: [
            @if(isset($wechat['subscribe_content']['img']))"{{$wechat['subscribe_content']['img']}}"@endif
        ],
        initialPreviewConfig: [
                @if(isset($wechat['subscribe_content']['img'])){width: "120px", url: "del-file", key: "{{$wechat['subscribe_content']['img']}}"},@endif
        ],
        previewSettings: {
            image: {width: "140px", height: "160px"},
        },
        deleteExtraData: function (previewId, index) {
            var obj = {};
            obj._method = 'get';
            // obj._token = 'csrf_token()}}';
            return obj;
        }
    };


    function newPluginInit() {
        $("body").append('<script type="text/javascript" src="/vendor/laravel-admin/bootstrap-fileinput/js/locals/zh.js"><\/script>');
        $("body").append('<script type="text/javascript" src="/vendor/laravel-admin/jquery-ajaxform/jquery.ajaxform.js"><\/script>');
        $('.fileinput').fileinput(fileinputOptions);
        $(".select2").select2();
    }
    $(function () {
        newPluginInit();

        $(".select2").on('change', function () {
            console.log($(this).find('option:selected').html())
            if ($(this).find('option:selected').val() > 0) {
                $("#" + $(this).data('for')).val($(this).find('option:selected').html())
            }
        })

        // è¡¨å•æäº¤
        var enAjaxForm = true;
        $(".ajaxform").ajaxForm({
            url: "#",
            beforeSubmit: ajaxFormBefore,
            success: ajaxFormSuccess,
            error: ajaxFormSuccess,
            dataType: 'json'
        });
        //å¤±è´¥ä¸è·³è½¬
        function ajaxFormSuccess(rel) {
            // console.log(rel);
            if (rel.code == 302) {
                setTimeout(function(){
                    $.pjax({url: rel.url, container: '#pjax-container'})
                }, 1000);
            }else {
                // å¤±è´¥æ‰é‡ç½®è¡¨å•ä¸ºå¯æäº¤çŠ¶æ€
                enAjaxForm = true;
            }
            if (typeof layer == 'undefined') {
                alert(rel.msg);
            } else {
                layer.msg(rel.msg);
            }
        }
        function ajaxFormBefore() {
            if (!enAjaxForm) {
                layer.msg('æ­£åœ¨æäº¤...');
                return false;
            } else {
                enAjaxForm = false;
                return true;
            }
        }
    });
</script>
